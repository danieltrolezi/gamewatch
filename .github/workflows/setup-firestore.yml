name: Setup Firestore Emulator

on:
  workflow_call:

jobs:
  firestore:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4

    - uses: actions/setup-node@v4
      with:
        node-version: 18

    - name: Install OpenJDK 11
      run: |
        sudo apt update
        sudo apt install -y openjdk-11-jdk

    - name: Install Firebase Tools
      run: sudo npm install -g firebase-tools
    
    - name: Start Firestore Emulator
      run: |
        cd ./docker/firebase
        firebase emulators:start --only firestore --project ${{ vars.GCP_PROJECT_ID }} &
        cc ../..
